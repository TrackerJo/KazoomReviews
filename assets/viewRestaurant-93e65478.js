import{r,j as l,a as e,I as A,g as L,F as x,J as k,K as E,c as F,R as I,L as P,M as b,N as f,O as D,P as O,Q as B}from"./index-5ef40ff5.js";function T({isShown:t,setIsShown:o,restaurant:h,updateReviews:v,oldReview:w,reviewsSeen:u}){const[s,d]=r.exports.useState(w);function m(R){o("hidden")}function c(R){d({...s,Rating:R.target.value})}function p(R){d({...s,Description:R.target.value})}async function g(R){await A(h,w.Owner,s),v(u),o("hidden")}return l("div",{className:"Prompt",id:t,children:[e("img",{src:"/assets/x_circle_fill.png",alt:"exit prompt",className:"exit",onClick:m}),e("h1",{children:"Edit Review"}),e("label",{children:"Rating"}),e("br",{}),e("input",{type:"number",min:"1",max:"5",onChange:c,value:s.Rating}),e("br",{}),e("label",{children:"Review"}),e("br",{}),e("textarea",{rows:"4",cols:"30",onChange:p,value:s.Description}),e("br",{}),e("button",{onClick:g,children:"Submit"})]})}function V({review:t,updateReviews:o,restaurant:h,reviewsSeen:v}){const[w,u]=r.exports.useState(!1),[s,d]=r.exports.useState("hidden");return r.exports.useEffect(()=>{L().then(m=>{m==t.Owner&&u(!0)})},[]),l(x,{children:[l("div",{className:"reviewBox",children:[w?e("img",{src:"/assets/pencil.png",alt:"edit review",className:"edit",onClick:()=>d("visible")}):null,e("label",{className:"rName",children:t.Name}),l("label",{className:"rRating",children:["★".repeat(t.Rating),"☆".repeat(5-t.Rating)]}),e("div",{className:"review",children:e("p",{children:t.Description})})]}),k.exports.createPortal(e(T,{isShown:s,setIsShown:d,restaurant:h,updateReviews:o,oldReview:t,reviewsSeen:v}),document.querySelector(".Reviews"))]})}function $({isShown:t,setIsShown:o,restaurant:h,updateReviews:v,reviewsSeen:w}){const[u,s]=r.exports.useState(0),[d,m]=r.exports.useState("");function c(n){o("hidden")}function p(n){s(n.target.value)}function g(n){m(n.target.value)}async function R(n){await E(h,u,d),v(w),o("hidden")}return l("div",{className:"Prompt",id:t,children:[e("img",{src:"/assets/x_circle_fill.png",alt:"exit prompt",className:"exit",onClick:c}),e("h1",{children:"Add Review"}),e("label",{children:"Rating"}),e("br",{}),e("input",{type:"number",min:"1",max:"5",onChange:p}),e("br",{}),e("label",{children:"Review"}),e("br",{}),e("textarea",{rows:"4",cols:"30",onChange:g}),e("br",{}),e("button",{onClick:R,children:"Submit"})]})}function j({reviews:t,restaurant:o,updateReviews:h,reviewsSeen:v,setReviewsSeen:w}){const[u,s]=r.exports.useState("hidden");function d(c){s("visible")}async function m(c){h(c.target.value)}return l(x,{children:[e("br",{}),e("label",{className:"title",children:"Reviews"})," ",e("img",{className:"add",src:"/assets/plus_fill_white.png",alt:"add review",onClick:d}),e("br",{}),e("label",{htmlFor:"reviewsSeen",children:"Reviews Shown: "}),l("select",{name:"reviewsSeen",id:"reviewsSeen",onChange:m,children:[e("option",{value:"everyone",children:"Everyone"}),e("option",{value:"friends",children:"Friends"}),e("option",{value:"similar preferences",children:"People with similar preferences"})]}),e("br",{}),e("br",{}),e("div",{className:"reviewsBox",children:e("div",{className:"reviews",children:t.map(c=>e(V,{review:c,updateReviews:h,restaurant:o,reviewsSeen:v},c.id))})}),e($,{isShown:u,setIsShown:s,restaurant:o,updateReviews:h,reviewsSeen:v})]})}F.createRoot(document.getElementById("root")).render(e(I.StrictMode,{children:e(q,{})}));function q(){const[t,o]=r.exports.useState([]),[h,v]=r.exports.useState([]),[w,u]=r.exports.useState(0);r.exports.useState("hidden");const[s,d]=r.exports.useState("everyone"),[m,c]=r.exports.useState(!1),[p,g]=r.exports.useState("/assets/white_star_empty.png"),n=new URLSearchParams(window.location.search).get("restaurant");r.exports.useEffect(()=>{P(n).then(a=>{o(a),b(n,s,a.Category).then(i=>{v(i),console.log(i)}),f(n,s,a.Category).then(i=>{u(i)}),D(n).then(i=>{i&&(c(!0),g("/assets/white_star_fill.png"))})})},[]);async function S(a){console.log("updating reviews"),d(a),console.log(s),b(n,a,t.Category).then(i=>{v(i)}),f(n,a,t.Category).then(i=>{u(i)})}function N(a){const i=document.querySelector(".Reviews");i.classList.contains("hideReviews")?(i.classList.remove("hideReviews"),i.classList.add("showAnimReviews"),a.target.innerText="Hide Reviews"):i.classList.contains("showAnimReviews")?(i.classList.add("hideAnimReviews"),i.classList.remove("showAnimReviews"),a.target.innerText="View Reviews"):i.classList.contains("hiddenReviews")&&(i.classList.remove("hiddenReviews"),i.classList.add("showAnimReviews"),a.target.innerText="Hide Reviews")}function C(){const a=document.querySelector(".Reviews");a.classList.contains("hideAnimReviews")&&(a.classList.add("hideReviews"),a.classList.remove("hideAnimReviews"))}function y(a){window.location.href="/index.html"}async function _(a){m?(c(!1),g("/assets/white_star_empty.png"),await O(n)):(c(!0),g("/assets/white_star_fill.png"),await B(n))}return l("div",{className:"Restaurant",children:[l("div",{className:"Info",children:[e("br",{}),e("img",{src:"/assets/white_back_arrow.png",alt:"back arrow",className:"back",onClick:y}),e("label",{className:"name",children:t.Name}),e("img",{src:p,alt:"favorite restaurant",id:"favorite",onClick:_})," ",e("label",{className:"price",children:"$".repeat(t.Price)}),e("table",{className:"photoLoc",children:l("tr",{children:[l("th",{children:[e("p",{children:t.Description}),l("a",{href:t.Website,children:[t.Name,"'s Website"]}),e("br",{}),e("label",{children:t.Address}),e("br",{}),e("label",{children:t.City}),e("br",{}),e("label",{children:t.State})]}),e("th",{children:e("img",{src:t.Photo,className:"photo"})})]})}),l("label",{children:["Category: ",t.Category]}),e("br",{}),l("label",{children:["Rating (",s,")"]}),e("br",{}),l("label",{className:"aRating",children:["★".repeat(w),"☆".repeat(5-w)]}),e("br",{}),e("button",{onClick:N,children:"View Reviews"})]}),e("div",{className:"Reviews hiddenReviews",onAnimationEnd:C,children:e(j,{reviews:h,restaurant:n,updateReviews:S,reviewsSeen:s,setReviewsSeen:d})})]})}
